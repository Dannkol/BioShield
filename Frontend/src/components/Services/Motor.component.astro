---

---

<p>
    <div
        class="flex flex-row items-center grid grid-cols-1 sm:grid-cols-1 md:grid-cols-3 gap-4 m-6"
    >
        <div class="relative flex flex-col items-center md:flex-row">
            <div
                class="flex flex-col md:flex-row md:items-center md:justify-center w-full"
            >
                <div
                    class="flex flex-col items-center border border-gray-300 rounded-md p-4 shadow-md w-full md:w-auto"
                >
                    <h1
                        class="text-2xl md:text-3xl font-bold leading-normal mb-2"
                    >
                        Estado
                    </h1>
                    <div class="flex flex-row justify-between w-full">
                        <div class="flex flex-col items-center">
                            <span class="text-xl font-semibold" id="motor"
                                >Inactivo</span
                            >
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="relative flex flex-col items-center md:flex-row">
            <div
                class="flex flex-col md:flex-row md:items-center md:justify-center w-full"
            >
                <div
                    class="flex flex-col items-center border border-gray-300 rounded-md p-4 shadow-md w-full md:w-auto"
                >
                    <button
                        class="text-2xl md:text-3xl font-bold leading-normal mb-2"
                        id="startBtn">Iniciar Motor</button
                    >
                </div>
            </div>
        </div>
        <div class="relative flex flex-col items-center md:flex-row">
            <div
                class="flex flex-col md:flex-row md:items-center md:justify-center w-full"
            >
                <div
                    class="flex flex-col items-center border border-gray-300 rounded-md p-4 shadow-md w-full md:w-auto"
                >
                    <button
                        class="text-2xl md:text-3xl font-bold leading-normal mb-2"
                        id="stopBtn">Detener Motor</button
                    >
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Crear conexión WebSocket con el ESP32 (usar la dirección IP del ESP32)
        const websocket = new WebSocket("ws://172.20.10.9:81");

        // Manejar la conexión abierta
        websocket.onopen = function (event) {
            console.log("Conectado al WebSocket del ESP32");
        };

        // Manejar mensajes recibidos
        websocket.onmessage = function (event) {
            // Parsear los datos JSON
            const data = JSON.parse(event.data);
            document.getElementById("temp").textContent = data.temperature;
            document.getElementById("humidity").textContent = data.humidity;
            document.getElementById("motor").textContent = data.motorActive
                ? "Activo"
                : "Inactivo";
        };

        // Manejar la desconexión
        websocket.onclose = function (event) {
            console.log("Desconectado del WebSocket");
        };

        // Manejar errores
        websocket.onerror = function (event) {
            console.log("Error: " + event);
        };

        // Iniciar motor cuando se presiona el botón
        document
            .getElementById("startBtn")
            .addEventListener("click", function () {
                websocket.send("START_MOTOR");
            });

        // Detener motor cuando se presiona el botón
        document
            .getElementById("stopBtn")
            .addEventListener("click", function () {
                websocket.send("STOP_MOTOR");
            });
    </script>
</p>
